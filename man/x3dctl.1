.TH X3DCTL 1 "2026" "x3dctl" "User Commands"

.SH NAME
x3dctl \- Deterministic AMD X3D mode and affinity controller

.SH SYNOPSIS
.B x3dctl
.RI [ options ] " command " [ application ... ]

.SH DESCRIPTION
x3dctl is a command-line utility for switching AMD X3D CPU operating modes
via the kernel sysfs interface and applying CPU affinity policies to launched
applications.

The tool separates policy from mechanism:

- The frontend determines execution policy.
- A restricted helper binary performs privileged sysfs and affinity operations.

When launching an application, x3dctl pins the current shell before exec.
The application and all of its children inherit the configured CPU affinity.

.SH COMMANDS

.TP
.B run
Launch an application using the mode defined in
.I /etc/x3dctl.conf.
If no configuration entry exists, the default mode is
.B cache.

Usage:
.B x3dctl run <command> [args...]

.TP
.B gaming
Switch to cache-priority mode.
If an application is provided, it is executed after switching mode and
pinning affinity.

.TP
.B performance
Switch to frequency-priority mode.
If an application is provided, it is executed after switching mode and
pinning affinity.

.TP
.B toggle
Switch to the opposite of the current mode.
If an application is provided, it is executed after switching mode and
pinning affinity.

.TP
.B status
Display the current X3D operating mode.

.SH OPTIONS

.TP
.BR -v ", " --verbose
Enable verbose logging of mode changes and affinity actions.

.TP
.BR -q ", " --quiet
Suppress informational output (errors are still displayed).

.SH CONFIGURATION

.TP
.I /etc/x3dctl.conf
System-wide configuration file mapping application names to modes.

Format:
.EX
application=cache
application=frequency
.EE

Example:
.EX
steam=cache
blender=frequency
.EE

The key must match the application's basename.

.SH APPLICATION PASSTHROUGH

When an application is specified after a command, x3dctl:

1. Switches the global X3D mode.
2. Pins the current shell to the appropriate CCD.
3. Executes the application via exec.

All child processes inherit the CPU affinity mask.

Example:
.EX
x3dctl gaming steam
x3dctl run steam
.EE

.SH SECURITY

x3dctl delegates privileged operations to:

.I /usr/local/bin/x3dctl-helper

The helper is executed via sudo and restricted through:

.I /etc/sudoers.d/x3dctl

The helper performs validated sysfs writes and controlled affinity changes.
No configuration parsing occurs in privileged context.

.SH FILES

.TP
.I /usr/local/bin/x3dctl
Frontend command-line interface.

.TP
.I /usr/local/bin/x3dctl-helper
Privileged helper binary.

.TP
.I /etc/x3dctl.conf
System policy configuration file.

.TP
.I /etc/sudoers.d/x3dctl
Sudo policy for helper execution.

.SH EXIT STATUS

.TP
0
Success

.TP
1
Invalid usage or runtime failure

.SH EXAMPLES

Switch to cache mode:
.EX
x3dctl gaming
.EE

Switch to frequency mode:
.EX
x3dctl performance
.EE

Toggle current mode:
.EX
x3dctl toggle
.EE

Launch using configuration:
.EX
x3dctl run steam
.EE

Switch mode and launch:
.EX
x3dctl gaming mangohud steam
.EE

Display current mode:
.EX
x3dctl status
.EE

.SH AUTHOR
Written by GrandBirdLizard.

.SH LICENSE
MIT 

